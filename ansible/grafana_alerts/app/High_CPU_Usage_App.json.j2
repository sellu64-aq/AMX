{
  "uid": "{{ alert_uid }}",
  "title": "High CPU Usage Server",
  "folderUID": "{{ folder_uid }}",
  "ruleGroup": "{{ rulegroup }}",        
  "condition": "C",
          "data": [
            {
              "refId": "A",
              "relativeTimeRange": {"from": 300, "to": 0},
              "datasourceUid": "{{ datasourceUid }}",
              "model": {
                "datasource": {
                  "type": "influxdb",
                  "uid": "{{ datasourceUid }}"
                },
                "instant": true,
                "intervalMs": 1000,
                "maxDataPoints": 43200,
                "query": "SELECT last(cpu_percent) FROM app_metrics\nWHERE $timeFilter\nGROUP BY time($interval), app,host,project,zone fill(0)\n",
                "rawQuery": true,
                "refId": "A",
                "resultFormat": "time_series"
              }
            },
            {
              "refId": "B",
              "relativeTimeRange": {"from": 0, "to": 0},
              "datasourceUid": "__expr__",
              "model": {
                "conditions": [
                  {
                    "evaluator": { "params": [0, 0], "type": "gt" },
                    "operator": {"type": "and"},
                    "query": {"params": []},
                    "reducer": {"params": [], "type": "avg"},
                    "type": "query"
                  }
                ],
                "datasource": {
                  "name": "Expression",
                  "type": "__expr__",
                  "uid": "__expr__"
                },
                "expression": "A",
                "intervalMs": 1000,
                "maxDataPoints": 43200,
                "reducer": "mean",
                "refId": "B",
                "type": "reduce"
              }
            },
            {
              "refId": "C",
              "relativeTimeRange": {"from": 0, "to": 0},
              "datasourceUid": "__expr__",
              "model": {
                "conditions": [
                  {
                    "evaluator": { "params": [90, 0], "type": "gt" },
                    "operator": {"type": "and"},
                    "query": {"params": []},
                    "reducer": {"params": [], "type": "avg"},
                    "type": "query"
                  }
                ],
                "datasource": {
                  "name": "Expression",
                  "type": "__expr__",
                  "uid": "__expr__"
                },
                "expression": "B",
                "intervalMs": 1000,
                "maxDataPoints": 43200,
                "refId": "C",
                "type": "threshold"
              }
            }
          ],
          "noDataState": "OK",
          "execErrState": "Error",
          "for": "1m",
          "annotations": {},
          "labels": {
            "platform": "{{ project }}",
            "zone": "{{ zone }}",
            "severity": "CRITICAL",
            "type": "{{ (rulegroup | string).split('_')[0] }}"
          },
          "isPaused": false
        }
